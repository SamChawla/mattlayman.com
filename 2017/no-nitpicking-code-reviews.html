<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel='stylesheet' href='/screen.css'>
  <link href='http://fonts.googleapis.com/css?family=Cabin:600|Lora:400,700'
    rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <title>No nitpicking in code reviews - mattlayman.com</title>
  <meta name='viewport' content='width=device-width' />
  <meta property="og:type" content="article" />
<meta property="og:url" content="http://www.mattlayman.com/2017/no-nitpicking-code-reviews.html" />
<meta property="og:image" content="http://www.mattlayman.com/2017/nitpick.jpg" />
<meta property="og:title" content="No nitpicking in code reviews" />
<meta property="og:description" content="Code reviews improve the quality of software. But a code review can be done badly. In this post, we'll look at some tools to make your code reviews as effective as possible." />
  <meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mblayman" />
<meta name="twitter:image" content="http://www.mattlayman.com/2017/nitpick.jpg" />
<meta name="twitter:title" content="No nitpicking in code reviews" />
<meta name="twitter:description" content="Code reviews improve the quality of software. But a code review can be done badly. In this post, we'll look at some tools to make your code reviews as effective as possible." />
  <link rel='alternate' href='/feed.xml' title="Matt Layman's Writings"
    type='atom+xml'>
  <script src="//load.sumome.com/" data-sumo-site-id="bebd12621ec197c6697df2c9248f3a0e593a38b2eae32e10899930dae8668b9a" async="async"></script>
</head>
<body lang='en'>
<div id='container'>
  <h1>No nitpicking in code reviews</h1>
<p class='byline'>By <a href='/'>Matt Layman</a> on July 18, 2017</p>
<p><img class='book' src='nitpick.jpg'></p>
<p><em>Two hours.</em>
I sat
in an excruciatingly cold conference room
while enduring the code review meeting
that would never end.
The contract demanded formal code reviews
so we had a room full of engineers
wearing many hats.
A moderator,
lead reviewer,
other reviewers,
scribe
and more &ldquo;interested&rdquo; parties
stared at code
on a projector.
The code in question
was thousands of lines long
and was a
big subsystem
in a major satellite software.
This code review was a crucial milestone
before handing off the component
to an integration test team.</p>
<p><em>Were we discussing the critical functions
of the code?
Did we explore the best ways to express
the system
to solidify a software component destined
for space?</em></p>
<p><strong>No</strong>, we quibbled
about the lengths
of lines of code
and where to capitalize letters
in variable names.
The group had
to reach a conclusion
about every comment added
to a long spreadsheet
of comments,
and 90% of the comments were <strong>nitpicks</strong>.</p>
<blockquote>
<p>How did a group
of intelligent engineers end up
in this horrible scenario?</p>
</blockquote>
<p>I&rsquo;m sure there were many reasons,
but a big contributor was <strong>failing
to let computers do what computers are good at.</strong>
Computers can automate the boring verification work,
but we didn&rsquo;t use them for that task.</p>
<p>The project demanded
that all code adhere
to a certain style
and conform
in 100% of cases.
The trouble
with the style
is that the team made choices
that were not enforceable
by an automated tool.
The combination
of complete compliance
and not being machine checkable meant
that reviewers had to spend more time examining <strong>the layout</strong>
of the code
instead of <strong>the content</strong>.
<em>This combo was a massive waste of time.</em></p>
<blockquote>
<p>How could this have been different?</p>
</blockquote>
<p>We could have improved these reviews
if we selected a coding style
that a computer could verify.</p>
<h2>A &ldquo;no nitpicking&rdquo; code review</h2>
<p>Let&rsquo;s contrast that terrible code review experience
with a Storybird code review.
At <a href="https://storybird.com/">Storybird</a>,
all code goes through a GitHub
<a href="https://help.github.com/articles/about-pull-requests/">pull request</a>.</p>
<p>In a pull request,
the software runs through a series of checks
in a continuous integration environment.
If any check fails,
we refuse to merge the code.
This philosophy adds an excellent level
of quality control.</p>
<p>What checks do we execute?</p>
<ul>
<li>A full run of the Python unit test suite</li>
<li>A full run of the JavaScript unit test suite</li>
<li>Style checks for Python code</li>
</ul>
<p>For this post,
the item to unpack is &ldquo;Style checks.&rdquo;
The engineering team runs two tools
to check Python code style.
The first is <a href="http://flake8.pycqa.org/en/latest/">flake8</a>.
The second tool is <a href="http://isort.readthedocs.io/en/latest/">isort</a>.</p>
<p>flake8 is a static analysis tool
that compares Python code
to recommendations made
in the &ldquo;Style Guide for Python Code&rdquo;
(often referred to as <a href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a>).
Any code that does not match conventions is reported,
and the <code>flake8</code> executable exits
with an error code.</p>
<p>isort solves a narrower problem.
When the continuous integration environment runs <code>isort</code>,
the program will report any Python imports
that appear in an incorrect order
(where &ldquo;incorrect&rdquo; is a standard agreed upon
as a team).
If anything is incorrect,
<code>isort</code> also exits
with an error code.</p>
<p>When either of these tools report failure,
the continuous integration build is a failure.
Because Storybird has a policy
to only merge passing builds,
a developer must fix
whatever is reported by the checking tools.</p>
<p>This style of code review offers many benefits.</p>
<ul>
<li><em>No more nitpicking comments.</em>
  The developer must make the build pass
  and the tools dutifully report any issues
  without being a nag.</li>
<li><em>Higher quality standard.</em>
  A zero exception policy
  and machine enforcement
  means that all developers are held
  to a high bar.</li>
<li><em>Better review content.</em>
  The code reviewers are freed
  from thinking about the little stuff
  and can focus
  on the actual problem to solve.</li>
</ul>
<h2>A tale of two code reviews</h2>
<p>We covered two types of code review:</p>
<ul>
<li>The first review was highly manual,
  time consuming,
  and ineffective.</li>
<li>The other review leveraged computer automation.
  It didn&rsquo;t waste the time
  of engineers
  and helped the team
  more than hurt.</li>
</ul>
<p>I hope that you&rsquo;ve never had a code review experience
like my first example.
If you have,
you probably felt the frustration
that I did.
Changing company culture can be very hard,
but if you can move your team
toward using tools
that function as automated code reviewers,
you&rsquo;ll be more effective
and happier.</p>
<p>For those of you already on a team
with a solid continuous integration practice
and automated code checking,
<em>be thankful!</em></p>
<p>If you want to chat about this with me, I'm
  <a href="https://twitter.com/mblayman">@mblayman</a> on Twitter.</p>

<div class="posts">
  
      <div class="previous-post">
      <p>
        <a href="/2017/using-pipfile-for-fun-and-profit.html">
          &larr; Previous
          <br>
          Using Pipfile for fun and profit
        </a>
      </p>
      <p>
        Python has many methods to manage software package dependencies. The Python Packaging Authority proposed a new standard format called a Pipfile. Let's explore the reasons and benefits of a Pipfile and walk through converting a project to use one.
      </p>
      <div class="post-fade"></div>
    </div>
  </div>

<br clear="both">
<br>

<h2>Matt Layman</h2>

<div id='me-wrapper'>
<img id='me' src='/photo.jpg' width='120' height='120'>
</div>

<p>
  Matt is the lead software engineer at
  <a href="https://storybird.com" target="_blank">Storybird</a>.
</p>
<p>
  Always eager to talk about Python
  and other technology topics,
  Matt organizes
  <a href="https://www.meetup.com/python-frederick/" target="_blank">Python Frederick</a>
  in Frederick, Maryland (NW of Washington D.C.)
  and seeks to grow software skills
  for people in his community.
</p>
  <br>
  <footer>
    <p><img alt='Creative Commons Attribution 4.0 International License'
      src='/cc.png' width='80' height='15'> <a href='/'> Matt Layman</a>,
      2017</p>
  </footer>
</div>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-93541554-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html><!-- handrolled for excellence -->
