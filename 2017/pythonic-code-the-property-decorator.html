<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel='stylesheet' href='/screen.css'>
  <link href='http://fonts.googleapis.com/css?family=Cabin:600|Lora:400,700'
    rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <title>Pythonic code: the property decorator - mattlayman.com</title>
  <meta name='viewport' content='width=device-width' />
  <meta property="og:type" content="article" />
<meta property="og:url" content="http://www.mattlayman.com/2017/pythonic-code-the-property-decorator.html" />
<meta property="og:image" content="http://www.mattlayman.com/images/python.png" />
<meta property="og:title" content="Pythonic code: the property decorator" />
<meta property="og:description" content="In this series of posts, I'm going to examine common design patterns in Python that make Python code feel 'Pythonic.' The third post in the series focuses on the property decorator as a way to clean up your classes." />
  <meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mblayman" />
<meta name="twitter:image" content="http://www.mattlayman.com/images/python.png" />
<meta name="twitter:title" content="Pythonic code: the property decorator" />
<meta name="twitter:description" content="In this series of posts, I'm going to examine common design patterns in Python that make Python code feel 'Pythonic.' The third post in the series focuses on the property decorator as a way to clean up your classes." />
  <link rel='alternate' href='/feed.xml' title="Matt Layman's Writings"
    type='atom+xml'>
  <script src="//load.sumome.com/" data-sumo-site-id="bebd12621ec197c6697df2c9248f3a0e593a38b2eae32e10899930dae8668b9a" async="async"></script>
</head>
<body lang='en'>
<div id='container'>
  <h1>Pythonic code: the property decorator</h1>
<p class='byline'>By <a href='/'>Matt Layman</a> on April 11, 2017</p>
<p><img class='book' src='/images/python.png'></p>
<p>This post continues a series
on &ldquo;Pythonic&rdquo; code.
Pythonic code is code
that fits well
with the design
of the Python language.
My previous post looked at the
<a href="/2017/pythonic-code-the-with-statement.html">with statement</a>
and simplifying setup and tear down code.
This third post will examine the <code>property</code> decorator.</p>
<ol>
<li><a href="/2017/pythonic-code-the-list-comprehension.html">The list comprehension</a></li>
<li><a href="/2017/pythonic-code-the-with-statement.html">The with statement</a></li>
<li>The property decorator</li>
<li><a href="/2017/pythonic-code-built-in-functions.html">Built-in functions</a></li>
<li><a href="/2017/pythonic-code-using-standard-library.html">Using the standard library</a></li>
<li><a href="/2017/pythonic-code-leveraging-packages.html">Leveraging packages</a></li>
</ol>
<h2>The <code>property</code> decorator</h2>
<p>If you&rsquo;ve ever taken a class
on object oriented (OO) design,
then you&rsquo;ve likely been taught the value
of encapsulation.
You were told that you should keep the state
of your objects private
so that you&rsquo;re free to modify the class internals
as you see fit.
This is a noble goal
and it benefits you immensely.</p>
<p>If the course was in Java,
encapsulation quickly translated itself
to getters and setters
on your classes.
When coming to Python,
maybe your first class looks like this:</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">OhMyJava</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span>

    <span class="k">def</span> <span class="nf">set_foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foo</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span> <span class="o">=</span> <span class="n">foo</span>
</pre></div>


<p>If I were to review your code,
I might propose an alternative.</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AwwYeah</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</pre></div>


<p>WHAT!?
But,
how dare I violate encapsulation?
What happens when needs change,
and <code>foo</code> needs to be created dynamically from <code>bar</code>.
Doesn&rsquo;t that break anyone who used the code?</p>
<p>The Python language designers determined
that getting and setting attributes directly
feels far cleaner
than getter and setter methods.
Contrast these:</p>
<div class="codehilite"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">get_foo</span><span class="p">()</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">get_bar</span><span class="p">())</span>
<span class="c1"># vs.</span>
<span class="n">obj</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">foo</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">bar</span>
</pre></div>


<p>I hope you&rsquo;ll agree with the language designers
that the latter is easier to comprehend.
To make that style possible,
the language needed some way to achieve
what they wanted
without violating encapsulation.</p>
<p>Enter the <code>property</code> decorator.</p>
<p>The genius move was to add a new language feature
that makes it possible to extend your class
without violating the API
that you&rsquo;ve defined.
In our example,
<code>foo</code> is the public API.
Let&rsquo;s extend our code.</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AwwYeah</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bar</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;More awesome please: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bar</span><span class="p">)</span>

    <span class="nd">@foo.setter</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bar</span> <span class="o">=</span> <span class="s1">&#39;{} is great.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">AwwYeah</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="s1">&#39;Python&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">foo</span>
<span class="s1">&#39;More awesome please: Python is great.&#39;</span>
</pre></div>


<p>The <code>property</code> decorator is our secret weapon
to prevent encapulation blunders.
This new class changes what <code>foo</code> means
without breaking any users of the class.</p>
<p>Using <code>property</code> as a decorator
creates a getter method.
It&rsquo;s the difference between <code>a.foo()</code> and <code>a.foo</code>.
That seems minor,
but those parenthesis add up.
The <code>property</code> decorator enables a method
to masquerade as a plain object attribute.</p>
<p>Additionally,
you can create a setter method (i.e. <code>@foo.setter</code>)
as long as the name before <code>.setter</code> matches the method name
of the decorated property.
When you don&rsquo;t include a setter method,
the property is read only
and will raise an <code>AttributeError</code>
if you attempt to set it.</p>
<p>Creating getter and setter methods
by adding a decorator
is a powerful tool
that leads to exceptionally clean code.
The <code>property</code> decorator unlocks something awesome for us:</p>
<p><em>You can do the simplest thing possible
until you need more control</em>.</p>
<p>This characteristic allows developers
to write code quickly and succinctly.
If you want to know more about <code>property</code>,
check out the
<a href="https://docs.python.org/3/library/functions.html#property">documentation</a>.
So, go forth and stop writing Java-style getter and setter methods
in your Python code! :)</p>
<p>If you want to chat about this with me, I'm
  <a href="https://twitter.com/mblayman">@mblayman</a> on Twitter.</p>
  <br>
  <footer>
    <p><img alt='Creative Commons Attribution 4.0 International License'
      src='/cc.png' width='80' height='15'> <a href='/'> Matt Layman</a>,
      2017</p>
  </footer>
</div>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-93541554-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html><!-- handrolled for excellence -->
